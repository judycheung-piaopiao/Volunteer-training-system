"use strict";(self["webpackChunktraining"]=self["webpackChunktraining"]||[]).push([[770],{7770:function(e,t,n){n.r(t),n.d(t,{default:function(){return M}});var l=n(3396),s=n(9242),c=n(7139);const a=e=>((0,l.dD)("data-v-5b67b323"),e=e(),(0,l.Cn)(),e),o={class:"block-center"},i=a((()=>(0,l._)("span",null,"当前课程已选",-1))),u=[i],r={class:"block-center"},d=a((()=>(0,l._)("span",null,"当前课程未选",-1))),g=[d],f={class:"block-center"},h=a((()=>(0,l._)("span",{style:{color:"red","font-weight":"bold"}},"当前不在选课时间内",-1))),m=[h],v={class:"courseText-top"},p=a((()=>(0,l._)("br",null,null,-1))),w={class:"courseText"},k=a((()=>(0,l._)("br",null,null,-1))),_={class:"courseText"},b=a((()=>(0,l._)("br",null,null,-1))),y={class:"courseText"},x=a((()=>(0,l._)("br",null,null,-1))),Z={class:"tagtag2"},q=(0,l.Uk)("已选"),C={class:"tagtag"},S=["onClick"],F=["onClick"];function T(e,t,n,a,i,d){const h=(0,l.up)("van-nav-bar"),T=(0,l.up)("van-tag"),j=(0,l.up)("van-card"),z=(0,l.up)("van-list");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(h,{title:"班级列表","left-text":"返回","left-arrow":"",onClickLeft:a.back},null,8,["onClickLeft"]),(0,l.wy)((0,l._)("div",o,u,512),[[s.F8,a.isSelected]]),(0,l.wy)((0,l._)("div",r,g,512),[[s.F8,!a.isSelected]]),(0,l.wy)((0,l._)("div",f,m,512),[[s.F8,!a.flagin]]),(0,l.wy)((0,l._)("div",null,[(0,l.Wm)(z,{loading:a.loading,"onUpdate:loading":t[0]||(t[0]=e=>a.loading=e),finished:a.finished,"finished-text":"没有更多了","error-text":"加载失败",onLoad:a.onLoad},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.classes.list,(e=>((0,l.wg)(),(0,l.iD)("div",{key:e,class:"block"},[(0,l.Wm)(j,{class:"vancard"},{title:(0,l.w5)((()=>[(0,l._)("div",v,"班级名称："+(0,c.zw)(e.name),1),p,(0,l._)("div",w,"上课时间："+(0,c.zw)(e.time),1),k,(0,l._)("div",_,"上课地点："+(0,c.zw)(e.location),1),b,(0,l._)("div",y,"授课教师："+(0,c.zw)(e.teacherName),1),x])),tags:(0,l.w5)((()=>[])),footer:(0,l.w5)((()=>[(0,l._)("div",Z,[(0,l.wy)((0,l.Wm)(T,{plain:"",type:"success"},{default:(0,l.w5)((()=>[q])),_:2},1536),[[s.F8,e.selected]])]),(0,l._)("div",C,[(0,l.Wm)(T,{plain:"",type:"primary"},{default:(0,l.w5)((()=>[(0,l.Uk)("已报/上限: "+(0,c.zw)(e.nowpeople)+"/"+(0,c.zw)(e.maxPeople),1)])),_:2},1024)]),(0,l._)("div",null,[(0,l.wy)((0,l._)("div",{onClick:t=>a.xuankeconfirm(e.no),class:"commonButton"},"选课",8,S),[[s.F8,a.judgefull(e.nowpeople,e.maxPeople)]]),(0,l._)("div",{onClick:t=>a.tuikeconfirm(e.no),class:"deleteButton"},"退课",8,F)])])),_:2},1024)])))),128))])),_:1},8,["loading","finished","onLoad"])],512),[[s.F8,a.flagin]])])}n(6542);var j=n(1321),z=(n(8146),n(8135)),D=n(4870),H=n(678);const L=n(6265);var W={name:"Select",setup(){const e=(0,D.iH)(!1),t=(0,D.iH)(!1),n=(0,H.tv)(),s=(0,H.yj)(),c=s.query.number,a=s.query.courseid,o=s.query.email,i=(0,D.iH)(0),u=(0,D.qj)({list:[]}),r=(0,D.qj)({list:[]}),d=s.query.pwd,g=s.query.username,f=s.query.start,h=s.query.end,m=(0,D.iH)(0);function v(){const e=new Date,t=String(e.getFullYear());var n=String(e.getMonth()+1),l=String(e.getDate()),s=String(e.getHours()),c=String(e.getMinutes());1==n.length&&(n="0"+n),1==l.length&&(l="0"+l),1==s.length&&(s="0"+s),1==c.length&&(c="0"+c);const a=f.slice(0,4),o=f.slice(5,7),i=f.slice(8,10),u=f.slice(11,13),r=f.slice(14,16),d=h.slice(0,4),g=h.slice(5,7),v=h.slice(8,10),p=h.slice(11,13),w=h.slice(14,16);let k=0,_=0;k=t>a||t==a&&(n>o||n==o&&(l>i||l==i&&(s>u||s==u&&c>=r)))?1:0,_=t<d||t==d&&(n<g||n==g&&(l<v||l==v&&(s<p||s==p&&c<=w)))?1:0,m.value=k&&_?1:0}function p(){i.value=0,L({method:"get",url:"student/checkselectedclass",params:{number:c}}).then((function(e){r.list=e.data})).catch((function(e){console.log("catch"+e),(0,z.Z)("获取班级信息失败，请检查网络")})),setTimeout((()=>{L({method:"get",url:"admin/getclass",params:{course:a}}).then((function(n){for(let e=0;e<n.data.length;e++){u.list=n.data,u.list[e].selected=0;for(let t=0;t<r.list.length;t++)r.list[t].no==u.list[e].no&&(u.list[e].selected=1,i.value++)}e.value=!1,t.value=!0})).catch((function(e){console.log("catch"+e),(0,z.Z)("获取班级信息失败，请检查网络")}))}),100)}function w(e){j.Z.confirm({message:"确认选课？"}).then((()=>{_(e)})).catch((()=>{}))}function k(e){j.Z.confirm({message:"确认退课？"}).then((()=>{b(e)})).catch((()=>{}))}function _(e){let t={name:"",number:c,classes:e,course:a};L({method:"get",url:"student/getstudent",params:{email:o}}).then((function(e){t.name=e.data[0].name})).catch((function(e){console.log("catch"+e),(0,z.Z)("用户信息获取失败，请检查网络")})),setTimeout((()=>{L({method:"get",url:"student/chooseclass",params:t}).then((function(t){if(t.data.statuscode>=1){(0,z.Z)("选课成功");for(let t=0;t<u.list.length;t++)u.list[t].no==e&&(u.list[t].selected=1);n.go(0)}else(0,z.Z)("选课失败")})).catch((function(e){console.log("catch"+e),(0,z.Z)("选课失败，请检查网络")}))}),100)}function b(e){let t={number:c,classes:e};L({method:"get",url:"student/exitclass",params:t}).then((function(t){if(t.data.statuscode>=1){(0,z.Z)("退课成功");for(let t=0;t<u.list.length;t++)u.list[t].no==e&&(u.list[t].selected=0);n.go(0)}else(0,z.Z)("退课失败")})).catch((function(e){console.log("catch"+e),(0,z.Z)("退课失败，请检查网络")}))}function y(e,t){return!(e>=t)}(0,l.wF)((()=>{L({method:"get",url:"user/login",params:{username:g,password:d,userlevel:"1"}}).then((function(e){3==e.data.statuscode||n.push("/force")})).catch((function(e){console.log("catch"+e),(0,z.Z)("登陆失败，请检查网络")}))})),(0,l.bv)((()=>{v()}));const x=()=>history.back(),Z=()=>n.go(0);return{loading:e,finished:t,back:x,refresh:Z,classes:u,number:c,xuanke:_,judgefull:y,tuike:b,onLoad:p,courseid:a,selected:r,tuikeconfirm:k,xuankeconfirm:w,isSelected:i,flagin:m,judgeTime:v}}},U=n(89);const B=(0,U.Z)(W,[["render",T],["__scopeId","data-v-5b67b323"]]);var M=B}}]);
//# sourceMappingURL=770.aeb28f7a.js.map