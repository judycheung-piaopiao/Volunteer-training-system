"use strict";(self["webpackChunktraining"]=self["webpackChunktraining"]||[]).push([[524],{8524:function(e,t,l){l.r(t),l.d(t,{default:function(){return F}});var n=l(3396),s=l(7139),i=l(9242);const c=e=>((0,n.dD)("data-v-1e02df60"),e=e(),(0,n.Cn)(),e),o={class:"block-center"},a={class:"block-center"},u=c((()=>(0,n._)("span",{style:{color:"red","font-weight":"bold"}},"警告：您有课程时间重合，请检查并退改选",-1))),r=[u],d={class:"block-center"},h=c((()=>(0,n._)("span",{style:{color:"red","font-weight":"bold"}},"当前不在选课时间内",-1))),g=[h],m={class:"courseText-top"},f=c((()=>(0,n._)("br",null,null,-1))),v={class:"courseText"},w=c((()=>(0,n._)("br",null,null,-1))),b={class:"courseText"},p=c((()=>(0,n._)("br",null,null,-1))),_={class:"courseText"},k=c((()=>(0,n._)("br",null,null,-1))),y={class:"courseText"},C=c((()=>(0,n._)("br",null,null,-1))),H={class:"tagtag"},z={class:"keButton"},q=["onClick"];function x(e,t,l,c,u,h){const x=(0,n.up)("van-nav-bar"),T=(0,n.up)("van-tag"),Z=(0,n.up)("van-card"),S=(0,n.up)("van-list");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(x,{title:"已选课程","left-text":"返回","left-arrow":"",onClickLeft:c.back},null,8,["onClickLeft"]),(0,n._)("div",o," 必修："+(0,s.zw)(c.mustChoseNum*c.mustPoints)+"/"+(0,s.zw)(c.allMust*c.mustPoints)+"学分 选修："+(0,s.zw)(c.selecChoseNum*c.selecPoints)+"/"+(0,s.zw)(c.allSelec*c.selecPoints)+"学分 ",1),(0,n.wy)((0,n._)("div",a,r,512),[[i.F8,c.isCoincidence]]),(0,n.wy)((0,n._)("div",d,g,512),[[i.F8,!c.flagin]]),(0,n._)("div",null,[(0,n.Wm)(S,{loading:c.loading,"onUpdate:loading":t[0]||(t[0]=e=>c.loading=e),finished:c.finished,"finished-text":"没有更多了","error-text":"加载失败",onLoad:c.onLoad},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(c.selected.list,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e,class:"block"},[(0,n.Wm)(Z,{class:"vancard"},{title:(0,n.w5)((()=>[(0,n._)("div",m,"课程名称："+(0,s.zw)(e.coursename),1),f,(0,n._)("div",v,"班级名称："+(0,s.zw)(e.name),1),w,(0,n._)("div",b,"上课时间："+(0,s.zw)(e.time),1),p,(0,n._)("div",_,"上课地点："+(0,s.zw)(e.location),1),k,(0,n._)("div",y,"授课教师："+(0,s.zw)(e.teacherName),1),C])),tags:(0,n.w5)((()=>[])),footer:(0,n.w5)((()=>[(0,n._)("div",H,[(0,n.Wm)(T,{plain:"",type:"primary"},{default:(0,n.w5)((()=>[(0,n.Uk)("已报/上限: "+(0,s.zw)(e.nowpeople)+"/"+(0,s.zw)(e.maxPeople),1)])),_:2},1024)]),(0,n._)("div",z,[(0,n._)("div",{onClick:t=>c.tuikeconfirm(e.no),class:"deleteButton"},"退课",8,q)])])),_:2},1024)])))),128))])),_:1},8,["loading","finished","onLoad"])])])}l(6542);var T=l(1321),Z=(l(8146),l(8135)),S=l(4870),P=l(678);const j=l(6265);var D={name:"Select",setup(){const e=(0,S.iH)(!1),t=(0,S.iH)(!1),l=(0,P.tv)(),s=(0,P.yj)(),i=s.query.number,c=s.query.batchId,o=s.query.pwd,a=s.query.username,u=(s.query.email,(0,S.qj)({list:[]})),r=(0,S.qj)({list:[]}),d=(0,S.qj)({list:[]}),h=(0,S.iH)(0),g=(0,S.iH)(0),m=(0,S.iH)(0),f=(0,S.iH)(0),v=(0,S.iH)(2),w=(0,S.iH)(1),b=(0,S.iH)(!1),p=s.query.start,_=s.query.end,k=(0,S.iH)(0);function y(){const e=new Date,t=String(e.getFullYear());var l=String(e.getMonth()+1),n=String(e.getDate()),s=String(e.getHours()),i=String(e.getMinutes());1==l.length&&(l="0"+l),1==n.length&&(n="0"+n),1==s.length&&(s="0"+s),1==i.length&&(i="0"+i);const c=p.slice(0,4),o=p.slice(5,7),a=p.slice(8,10),u=p.slice(11,13),r=p.slice(14,16),d=_.slice(0,4),h=_.slice(5,7),g=_.slice(8,10),m=_.slice(11,13),f=_.slice(14,16);let v=0,w=0;v=t>c||t==c&&(l>o||l==o&&(n>a||n==a&&(s>u||s==u&&i>=r)))?1:0,w=t<d||t==d&&(l<h||l==h&&(n<g||n==g&&(s<m||s==m&&i<=f)))?1:0,k.value=v&&w?1:0}function C(){h.value=0,m.value=0;let l=0;setTimeout((()=>{j({method:"get",url:"student/showbatch",params:{number:i}}).then((function(e){l=e.data[0].no})).catch((function(e){console.log("catch"+e),(0,Z.Z)("获取批次信息失败，请检查网络")}))}),100),setTimeout((()=>{j({method:"get",url:"student/checkselectedclass",params:{number:i}}).then((function(e){d.list=e.data})).catch((function(e){console.log("catch"+e),(0,Z.Z)("获取班级信息失败，请检查网络")}))}),200),setTimeout((()=>{j({method:"get",url:"admin/getcourse",params:{batch:c}}).then((function(e){u.list=e.data})).catch((function(e){console.log("catch"+e),(0,Z.Z)("获取课程信息失败，请检查网络")}))}),200),setTimeout((()=>{for(let e=0;e<u.list.length;e++)u.list[e].mustchose&&m.value++;f.value=u.list.length-m.value;for(let e=0;e<d.list.length;e++){const t=d.list[e];for(let e=0;e<u.list.length;e++){const l=u.list[e];l.no==t.course&&(t.coursename=l.name,t.must=l.mustchose,1==t.must&&h.value++)}}g.value=d.list.length-h.value;for(let e=0;e<d.list.length-1;e++){const t=d.list[e].time;for(let l=e+1;l<d.list.length;l++){const e=d.list[l].time;if(t==e){b.value=!0;break}}}}),500),e.value=!1,t.value=!0}function H(e){0!=k.value?T.Z.confirm({message:"确认退课？"}).then((()=>{z(e)})).catch((()=>{})):(0,Z.Z)("不在选课时间内！")}function z(e){let t={number:i,classes:e};j({method:"get",url:"student/exitclass",params:t}).then((function(t){if(t.data.statuscode>=1){(0,Z.Z)("退课成功");for(let t=0;t<r.list.length;t++)r.list[t].no==e&&(r.list[t].selected=0);l.go(0)}else(0,Z.Z)("退课失败")})).catch((function(e){console.log("catch"+e),(0,Z.Z)("退课失败，请检查网络")}))}function q(e,t){return!(e>=t)}(0,n.wF)((()=>{j({method:"get",url:"user/login",params:{username:a,password:o,userlevel:"1"}}).then((function(e){3==e.data.statuscode||l.push("/force")})).catch((function(e){console.log("catch"+e),(0,Z.Z)("登陆失败，请检查网络")}))})),(0,n.bv)((()=>{y()}));const x=()=>history.back(),D=()=>l.go(0);return{loading:e,finished:t,back:x,refresh:D,classes:r,number:i,judgefull:q,tuike:z,onLoad:C,courses:u,selected:d,mustChoseNum:h,allMust:m,allSelec:f,mustPoints:v,selecPoints:w,selecChoseNum:g,tuikeconfirm:H,isCoincidence:b,judgeTime:y,flagin:k}}},L=l(89);const N=(0,L.Z)(D,[["render",x],["__scopeId","data-v-1e02df60"]]);var F=N}}]);
//# sourceMappingURL=524.686f0e68.js.map